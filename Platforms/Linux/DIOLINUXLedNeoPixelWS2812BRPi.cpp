/**-------------------------------------------------------------------------------------------------------------------
* 
* @file       DIOLINUXLedNeoPixelWS2812BRPi.cpp
* 
* @class      DIOLINUXLEDNEOPIXELWS2812BRPI
* @brief      LINUX Data Input/Output Led Neopixel WS2812B Raspberry Pi class
* @ingroup    DATAIO
* 
* @copyright  GEN Group. All rights reserved.
* 
* @cond
* Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated
* documentation files(the "Software"), to deal in the Software without restriction, including without limitation
* the rights to use, copy, modify, merge, publish, distribute, sublicense, and/ or sell copies of the Software,
* and to permit persons to whom the Software is furnished to do so, subject to the following conditions:
* 
* The above copyright notice and this permission notice shall be included in all copies or substantial portions of
* the Software.
* 
* THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO
* THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.IN NO EVENT SHALL THE
* AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,
* TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
* SOFTWARE.
* @endcond
* 
* --------------------------------------------------------------------------------------------------------------------*/

/*---- PRECOMPILATION INCLUDES ---------------------------------------------------------------------------------------*/
#pragma region PRECOMPILATION_INCLUDES

#include "GEN_Defines.h"

#pragma endregion


/*---- INCLUDES ------------------------------------------------------------------------------------------------------*/
#pragma region INCLUDES

#include "DIOLINUXLedNeoPixelWS2812BRPi.h"

#include <stdint.h>
#include <stdio.h>
#include <stdbool.h>
#include <stdlib.h>
#include <sys/mman.h>
#include <fcntl.h>
#include <time.h>      // for sleep
#include <errno.h>     // for sleep
#include <string.h>
#include <unistd.h>
#include <sys/types.h>
#include <sys/stat.h>
#include <sys/time.h>
#include <sys/resource.h>
#include <signal.h>
#include <stdarg.h>
#include <getopt.h>

#include "clk.h"
#include "gpio.h"
#include "dma.h"
#include "pwm.h"
#include "version.h"

#include "XBase.h"
#include "XTrace.h"
#include "XSleep.h"
#include "XBuffer.h"

#include "XMemory_Control.h"

#pragma endregion


/*---- GENERAL VARIABLE ----------------------------------------------------------------------------------------------*/
#pragma region GENERAL_VARIABLE


// according to https://wp.josh.com/2014/05/13/ws2812-neopixels-are-not-so-finicky-once-you-get-to-know-them/
// since we transmit 50ns at a time (20MHz) we will need to transmit 3 bytes (24 bits, 1200ns) per byte of data
// most fitting timings would be:
// ON 13 (650ns/50) bits high, 11 (550ns/50) bits low
// 11111111 11111000 00000000
// 0xff     0xf8     0x00
// OFF 7 (350ns/50) bits high, 17 (850ns/50) bits low
// 11111110 00000000 00000000
// 0xfe     0x00     0x00
// and to reset/latch
// RES 120 bits low (6000ns/50) == 15 bytes
// uint8_t on[3]  = { 0xff, 0xf8, 0x00 };
// uint8_t off[3] = { 0xfe, 0x00, 0x00 };
//
// OK, with 20MHz it's not setting the LEDs correctly
// guessing there's some flicker on the wire
// so we will use 10MHz and in this case we need 2 bytes per bit
// ON 7 (700ns) bits high, 9 (900ns) bits low
// 11111110 00000000
// 0xfe     0x00
// OFF 4 (400ns) bits high, 12 (1200ns) bits low
// 11110000 00000000
// 0xf0     0x00
//
// This will need 1600ns instead of 1200ns per byte of data which is ~30% slower, but that's fine.
// Given 60 LEDs, with 20MHz we need 1200ns * 3 (for each color) * 60 (for each led) == 216 microseconds.
// With 10MHz we need 288 microseconds.
// That's a difference of 72 microseconds per 60 LEDs, or ~1 microsecond per LED.
// With 1000 LEDs, that's 1 millisecond difference (that's still fast enough to render at 144 FPS).
// But I have 120 LEDs.
// So I don't care.

// instead of transforming one bit at a time, we will just read from a lookup table
// cause screw it, it's Raspberry 5, we got a ton of memory anyways

uint8_t lookup_table[256][16] = { { 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00 },
                                  { 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00 },
                                  { 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00 },
                                  { 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00 },
                                  { 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00 },
                                  { 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00 },
                                  { 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00 },
                                  { 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00 },
                                  { 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00 },
                                  { 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00 },
                                  { 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00 },
                                  { 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00 },
                                  { 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00 },
                                  { 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00 },
                                  { 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00 },
                                  { 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00 },
                                  { 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00 },
                                  { 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00 },
                                  { 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00 },
                                  { 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00 },
                                  { 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00 },
                                  { 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00 },
                                  { 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00 },
                                  { 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00 },
                                  { 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00 },
                                  { 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00 },
                                  { 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00 },
                                  { 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00 },
                                  { 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00 },
                                  { 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00 },
                                  { 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00 },
                                  { 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00 },
                                  { 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00 },
                                  { 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00 },
                                  { 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00 },
                                  { 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00 },
                                  { 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00 },
                                  { 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00 },
                                  { 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00 },
                                  { 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00 },
                                  { 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00 },
                                  { 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00 },
                                  { 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00 },
                                  { 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00 },
                                  { 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00 },
                                  { 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00 },
                                  { 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00 },
                                  { 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00 },
                                  { 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00 },
                                  { 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00 },
                                  { 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00 },
                                  { 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00 },
                                  { 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00 },
                                  { 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00 },
                                  { 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00 },
                                  { 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00 },
                                  { 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00 },
                                  { 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00 },
                                  { 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00 },
                                  { 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00 },
                                  { 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00 },
                                  { 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00 },
                                  { 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00 },
                                  { 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00 },
                                  { 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00 },
                                  { 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00 },
                                  { 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00 },
                                  { 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00 },
                                  { 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00 },
                                  { 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00 },
                                  { 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00 },
                                  { 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00 },
                                  { 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00 },
                                  { 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00 },
                                  { 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00 },
                                  { 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00 },
                                  { 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00 },
                                  { 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00 },
                                  { 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00 },
                                  { 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00 },
                                  { 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00 },
                                  { 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00 },
                                  { 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00 },
                                  { 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00 },
                                  { 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00 },
                                  { 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00 },
                                  { 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00 },
                                  { 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00 },
                                  { 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00 },
                                  { 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00 },
                                  { 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00 },
                                  { 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00 },
                                  { 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00 },
                                  { 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00 },
                                  { 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00 },
                                  { 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00 },
                                  { 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00 },
                                  { 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00 },
                                  { 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00 },
                                  { 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00 },
                                  { 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00 },
                                  { 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00 },
                                  { 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00 },
                                  { 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00 },
                                  { 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00 },
                                  { 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00 },
                                  { 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00 },
                                  { 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00 },
                                  { 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00 },
                                  { 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00 },
                                  { 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00 },
                                  { 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00 },
                                  { 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00 },
                                  { 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00 },
                                  { 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00 },
                                  { 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00 },
                                  { 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00 },
                                  { 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00 },
                                  { 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00 },
                                  { 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00 },
                                  { 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00 },
                                  { 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00 },
                                  { 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00 },
                                  { 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00 },
                                  { 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00 },
                                  { 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00 },
                                  { 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00 },
                                  { 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00 },
                                  { 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00 },
                                  { 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00 },
                                  { 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00 },
                                  { 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00 },
                                  { 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00 },
                                  { 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00 },
                                  { 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00 },
                                  { 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00 },
                                  { 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00 },
                                  { 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00 },
                                  { 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00 },
                                  { 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00 },
                                  { 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00 },
                                  { 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00 },
                                  { 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00 },
                                  { 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00 },
                                  { 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00 },
                                  { 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00 },
                                  { 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00 },
                                  { 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00 },
                                  { 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00 },
                                  { 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00 },
                                  { 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00 },
                                  { 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00 },
                                  { 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00 },
                                  { 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00 },
                                  { 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00 },
                                  { 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00 },
                                  { 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00 },
                                  { 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00 },
                                  { 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00 },
                                  { 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00 },
                                  { 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00 },
                                  { 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00 },
                                  { 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00 },
                                  { 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00 },
                                  { 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00 },
                                  { 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00 },
                                  { 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00 },
                                  { 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00 },
                                  { 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00 },
                                  { 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00 },
                                  { 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00 },
                                  { 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00 },
                                  { 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00 },
                                  { 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00 },
                                  { 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00 },
                                  { 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00 },
                                  { 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00 },
                                  { 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00 },
                                  { 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00 },
                                  { 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00 },
                                  { 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00 },
                                  { 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00 },
                                  { 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00 },
                                  { 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00 },
                                  { 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00 },
                                  { 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00 },
                                  { 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00 },
                                  { 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00 },
                                  { 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00 },
                                  { 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00 },
                                  { 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00 },
                                  { 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00 },
                                  { 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00 },
                                  { 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00 },
                                  { 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00 },
                                  { 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00 },
                                  { 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00 },
                                  { 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00 },
                                  { 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00 },
                                  { 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00 },
                                  { 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00 },
                                  { 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00 },
                                  { 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00 },
                                  { 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00 },
                                  { 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00 },
                                  { 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00 },
                                  { 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00 },
                                  { 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00 },
                                  { 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00 },
                                  { 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00 },
                                  { 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00 },
                                  { 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00 },
                                  { 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00 },
                                  { 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00 },
                                  { 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00 },
                                  { 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00 },
                                  { 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00 },
                                  { 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00 },
                                  { 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00 },
                                  { 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00 },
                                  { 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00 },
                                  { 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00 },
                                  { 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00 },
                                  { 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00 },
                                  { 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00 },
                                  { 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00 },
                                  { 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00 },
                                  { 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00 },
                                  { 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00 },
                                  { 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00 },
                                  { 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00 },
                                  { 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00 },
                                  { 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00 },
                                  { 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00 },
                                  { 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00 },
                                  { 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00 },
                                  { 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00 },
                                  { 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00 },
                                  { 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00 },
                                  { 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00 },
                                  { 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00 },
                                  { 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00 },
                                  { 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00 },
                                  { 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00 },
                                  { 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00 },
                                  { 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00 },
                                  { 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00 },
                                  { 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00 },
                                  { 0xf0, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00 },
                                  { 0xfe, 0x00, 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00 },
                                  { 0xf0, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00 },
                                  { 0xfe, 0x00, 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00 },
                                  { 0xf0, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00 },
                                  { 0xfe, 0x00, 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00 },
                                  { 0xf0, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00 },
                                  { 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00 }
                                };

const uint32_t spi_bases[] =    { RP1_SPI0_BASE   ,
                                  RP1_SPI1_BASE   ,
                                  RP1_SPI2_BASE   ,
                                  RP1_SPI3_BASE   ,
                                  RP1_SPI4_BASE   ,
                                  RP1_SPI5_BASE   ,
                                  RP1_SPI6_BASE   ,
                                  RP1_SPI7_BASE   ,
                                  RP1_SPI8_BASE   
                                };


#pragma endregion


/*---- CLASS MEMBERS -------------------------------------------------------------------------------------------------*/
#pragma region CLASS_MEMBERS


/**-------------------------------------------------------------------------------------------------------------------
*
* @fn         DIOLINUXLEDNEOPIXELWS2812BRPI::DIOLINUXLEDNEOPIXELWS2812BRPI()
* @brief      Constructor
* @ingroup    DATAIO
*
* --------------------------------------------------------------------------------------------------------------------*/
DIOLINUXLEDNEOPIXELWS2812BRPI::DIOLINUXLEDNEOPIXELWS2812BRPI()
{
  Clean();

  XLINUXIDRPI IDpi;  

  model = IDpi.GetModel();

  memset(&config, 0, sizeof(config));

  config.freq                  = NEOPIXELWS2812BRPI_DEFAULT_TARGET_FREQ;
  config.dmanum                = NEOPIXELWS2812BRPI_DEFAULT_DMA;
  
  config.channel[0].gpionum    = NEOPIXELWS2812BRPI_DEFAULT_GPIO_PIN;
  config.channel[0].count      = NEOPIXELWS2812BRPI_DEFAULT_LED_COUNT;
  config.channel[0].invert     = 0;
  config.channel[0].brightness = brightnesslevel;
  config.channel[0].strip_type = NEOPIXELWS2812BRPI_DEFAULT_STRIP_TYPE;
  
  config.channel[1].gpionum    = 0;
  config.channel[1].count      = 0;
  config.channel[1].invert     = 0;
  config.channel[1].brightness = 0;  
}


/**-------------------------------------------------------------------------------------------------------------------
*
* @fn         DIOLINUXLEDNEOPIXELWS2812BRPI::~DIOLINUXLEDNEOPIXELWS2812BRPI()
* @brief      Destructor
* @note       VIRTUAL
* @ingroup    DATAIO
*
* --------------------------------------------------------------------------------------------------------------------*/
DIOLINUXLEDNEOPIXELWS2812BRPI::~DIOLINUXLEDNEOPIXELWS2812BRPI()
{
  Clean();
}


/**-------------------------------------------------------------------------------------------------------------------
* 
* @fn         bool DIOLINUXLEDNEOPIXELWS2812BRPI::Ini(XDWORD nled)
* @brief      Ini
* @ingroup    DATAIO
* 
* @param[in]  nled : 
* 
* @return     bool : true if is succesful. 
* 
* --------------------------------------------------------------------------------------------------------------------*/
bool DIOLINUXLEDNEOPIXELWS2812BRPI::Ini(XDWORD nled)
{
  if(model == RPI_MODEL_B_4)
    {
      //--------------------------------------------------------------------------------------------------------------------
      // DMA support P4 (GPIO 18)

      config.channel[0].count = nled;

      databuffer.Resize(nled * 3);

      ws2811_return_t returnvalue = ws2811_init(&config);
      if(returnvalue != WS2811_SUCCESS) 
        {
          return false;
        }

      return true;
    }

  if(model == RPI_MODEL_B_5)
    { 
      //--------------------------------------------------------------------------------------------------------------------
      // SPI support P5 (GPIO 10)

      this->nled   = nled;
  
      databuffer.Resize(nled * 3);

      // get the peripheral base address
      void *base = MapGPIO(RP1_BAR1, RP1_BAR1_LEN);
      if(base == NULL) 
        {
          return false;
        }  

      // create a rp1 device 
      RP1_T* rp1 = NULL;
      if(!CreateRP1(&rp1, base))
        {
          return false;
        }
    
      // SPI
      // create a spi instance
 
      if(!RP1SPICreate(rp1, 0, &spi))
        {
          return false;
        }

      // disable the SPI
      *(volatile uint32_t *)(spi->regbase + DW_SPI_SSIENR) = 0x0;

      CreateMOSIPin(rp1, 0x00); // MOSI is all we need anyways

      // set the speed - this is the divisor from 200MHz in the RPi5
      *(volatile uint32_t *)(spi->regbase + DW_SPI_BAUDR) = 20; // 10 MHz
 
      // set mode - CPOL = 0, CPHA = 1 (Mode 1)
      // read control
      uint32_t reg_ctrlr0 = *(volatile uint32_t *)(spi->regbase + DW_SPI_CTRLR0);
 
       reg_ctrlr0 |= DW_PSSI_CTRLR0_SCPHA;
  
      // update the control reg
      *(volatile uint32_t *)(spi->regbase + DW_SPI_CTRLR0) = reg_ctrlr0;
      reg_ctrlr0 = *(volatile uint32_t *)(spi->regbase + DW_SPI_CTRLR0);

      // clear interrupts by reading the interrupt status register
      uint32_t reg_icr = *(volatile uint32_t *)(spi->regbase + DW_SPI_ICR);

      // enable the SPI
      *(volatile uint32_t *)(spi->regbase + DW_SPI_SSIENR) = 0x1;

      free(rp1);  

      return true;    
    }
 
  return false;
}


/**-------------------------------------------------------------------------------------------------------------------
*
* @fn         bool DIOLINUXLEDNEOPIXELWS2812BRPI::Send()
* @brief      Send
* @ingroup    DATAIO
*
* @return     bool : true if is succesful.
*
* --------------------------------------------------------------------------------------------------------------------*/
bool DIOLINUXLEDNEOPIXELWS2812BRPI::Send()
{
  if(model == RPI_MODEL_B_4)
    {
      //--------------------------------------------------------------------------------------------------------------------
      // DMA support P4 (GPIO 18)

      XBYTE* ptrdata  = databuffer.Get();
      XDWORD data     = 0;
      int    index    = 0;

      for(int c=0; c<config.channel[0].count; c++)
        {
          config.channel[0].leds[c] = 0;

          data = ptrdata[index];      
          config.channel[0].leds[c] |= data;           
          index++;

          data = ptrdata[index];      
          data <<= 8;
          config.channel[0].leds[c] |= data;           
          index++;

          data = ptrdata[index];      
          data <<= 16;
          config.channel[0].leds[c] |= data;           
          index++;

          data = 0xFF;      
          data <<= 24;
          config.channel[0].leds[c] |= data;                
        }

      config.channel[0].brightness = brightnesslevel;

      ws2811_return_t returnvalue = ws2811_render(&config);
      if(returnvalue != WS2811_SUCCESS) 
        { 
          return false;
        }

      return true;
    }

  if(model == RPI_MODEL_B_5)
    { 
      //--------------------------------------------------------------------------------------------------------------------
      // SPI support P5 (GPIO 10)

      XBUFFER buffer;
      float   normalizebrightness = 0.0f;

      if(GetBrightnessLevel() == 255)    
              normalizebrightness = 1.0f;    
        else  normalizebrightness = (float)GetBrightnessLevel()/(float)255.0f;

      buffer.CopyFrom(databuffer);

      for(int c=0; c<buffer.GetSize(); c+=3)
        {
          SWAPVAR(buffer.Get()[c], buffer.Get()[c+1])
        }
 
      for(int c=0; c<buffer.GetSize(); c++)
        {
          XBYTE value = (XBYTE) ((float)buffer.Get()[c] * normalizebrightness);  
          buffer.Get()[c] = value;            
        }    
     
      for(int c=0; c<buffer.GetSize(); c++)
        {
          buffer.Get()[c] = RotateByte(buffer.Get()[c]);            
        }    
        
      RP1SPIWriteArrayBlocking(spi, buffer.Get(), buffer.GetSize());

      return true;
    }

  return false;
}


/**-------------------------------------------------------------------------------------------------------------------
*
* @fn         bool DIOLINUXLEDNEOPIXELWS2812BRPI::End()
* @brief      End
* @ingroup    DATAIO
*
* @return     bool : true if is succesful.
*
* --------------------------------------------------------------------------------------------------------------------*/
bool DIOLINUXLEDNEOPIXELWS2812BRPI::End()
{  
  databuffer.FillBuffer();
  SetBrightnessLevel(0);
  Send();

  if(model == RPI_MODEL_B_4)
    {
      //--------------------------------------------------------------------------------------------------------------------
      // DMA support P4 (GPIO 18)

      ws2811_fini(&config);   
    }

  if(model == RPI_MODEL_B_5)
    {
      //--------------------------------------------------------------------------------------------------------------------
      // SPI support P5 (GPIO 10)

      if(spi)
        {
          free(spi);
        }  
    }

  Clean();

  return true;
}


/**-------------------------------------------------------------------------------------------------------------------
* 
* @fn         void* DIOLINUXLEDNEOPIXELWS2812BRPI::MapGPIO(off_t dev_base, off_t dev_size)
* @brief      MapGPIO
* @ingroup    PLATFORM_LINUX
* 
* @param[in]  dev_base : 
* @param[in]  dev_size : 
* 
* @return     void* : 
* 
* --------------------------------------------------------------------------------------------------------------------*/
void* DIOLINUXLEDNEOPIXELWS2812BRPI::MapGPIO(off_t dev_base, off_t dev_size)
{
  int fd;
  void *mapped;
  
  // printf("sizeof(off_t) %d\n", sizeof(off_t));
  
  if((fd = open("/dev/mem", O_RDWR | O_SYNC)) == -1)
    {
      return (void *)0;
    }
  
  mapped = mmap(0, dev_size, PROT_READ | PROT_WRITE, MAP_SHARED, fd, dev_base);
  // close(fd);
   
  if(mapped == (void *)-1)
    {
      return (void *)0;
    }

  return mapped;
}


/**-------------------------------------------------------------------------------------------------------------------
* 
* @fn         bool DIOLINUXLEDNEOPIXELWS2812BRPI::CreateRP1(RP1_T** rp1, void* base)
* @brief      CreateRP1
* @ingroup    PLATFORM_LINUX
* 
* @param[in]  rp1 : 
* @param[in]  base : 
* 
* @return     bool : true if is succesful. 
* 
* --------------------------------------------------------------------------------------------------------------------*/
bool DIOLINUXLEDNEOPIXELWS2812BRPI::CreateRP1(RP1_T** rp1, void* base)
{
  RP1_T* _rpi = (RP1_T *)calloc(1, sizeof(RP1_T));
  if(_rpi == NULL)
    {
      return false;
    }
  
  _rpi->rp1_peripherial_base  = base;
  _rpi->gpio_base             = base + RP1_IO_BANK0_BASE;
  _rpi->pads_base             = base + RP1_PADS_BANK0_BASE;
  _rpi->rio_out               = (volatile uint32_t *)(base + RP1_RIO0_BASE + RIO_OUT_OFFSET);
  _rpi->rio_output_enable     = (volatile uint32_t *)(base + RP1_RIO0_BASE + RIO_OE_OFFSET);
  _rpi->rio_nosync_in         = (volatile uint32_t *)(base + RP1_RIO0_BASE + RIO_NOSYNC_IN_OFFSET);
  
  *rp1 = _rpi;
  
  return true;
}


/**-------------------------------------------------------------------------------------------------------------------
* 
* @fn         bool DIOLINUXLEDNEOPIXELWS2812BRPI::CreateMOSIPin(RP1_T* rp1, uint32_t funcmask)
* @brief      CreateMOSIPin
* @ingroup    PLATFORM_LINUX
* 
* @param[in]  rp1 : 
* @param[in]  funcmask : 
* 
* @return     bool : true if is succesful. 
* 
* --------------------------------------------------------------------------------------------------------------------*/
bool DIOLINUXLEDNEOPIXELWS2812BRPI::CreateMOSIPin(RP1_T* rp1, uint32_t funcmask)
{
  uint8_t     mosi_pin_number = 10;
  GPIO_PIN_T* newpin          = ( GPIO_PIN_T*)calloc(1, sizeof(GPIO_PIN_T));
  
  if(newpin == NULL) 
    {
      return false;
    }
  
  newpin->number = mosi_pin_number;
  
  // each gpio has a status and control register
  // adjacent to each other. control = status + 4 (uint8_t)
  newpin->status  = (uint32_t *)(rp1->gpio_base + 8 * mosi_pin_number);
  newpin->ctrl    = (uint32_t *)(rp1->gpio_base + 8 * mosi_pin_number + 4);
  newpin->pad     = (uint32_t *)(rp1->pads_base + PADS_BANK0_GPIO_OFFSET + mosi_pin_number * 4);
  
  // set the function
  *(newpin->ctrl + RP1_ATOM_CLR_OFFSET / 4) = CTRL_MASK_FUNCSEL; // first clear the bits
  *(newpin->ctrl + RP1_ATOM_SET_OFFSET / 4) = funcmask;  // now set the value we need
  
  rp1->pins[mosi_pin_number] = newpin;
  //printf("pin %d stored in pins array %p\n", mosi_pin_number, rp1->pins[mosi_pin_number]);
  
  return true;
}


/**-------------------------------------------------------------------------------------------------------------------
* 
* @fn         uint8_t DIOLINUXLEDNEOPIXELWS2812BRPI::GetBit(uint8_t value, short bit)
* @brief      GetBit
* @ingroup    PLATFORM_LINUX
* 
* @param[in]  value : 
* @param[in]  bit : 
* 
* @return     uint8_t : 
* 
* --------------------------------------------------------------------------------------------------------------------*/
uint8_t DIOLINUXLEDNEOPIXELWS2812BRPI::GetBit(uint8_t value, short bit) 
{
  return (value >> (bit % 8)) & 1;
}


/**-------------------------------------------------------------------------------------------------------------------
* 
* @fn         uint8_t DIOLINUXLEDNEOPIXELWS2812BRPI::RotateByte(uint8_t byte)
* @brief      RotateByte
* @ingroup    PLATFORM_LINUX
* 
* @param[in]  byte : 
* 
* @return     uint8_t : 
* 
* --------------------------------------------------------------------------------------------------------------------*/
uint8_t DIOLINUXLEDNEOPIXELWS2812BRPI::RotateByte(uint8_t byte) 
{
  uint8_t resultado = 0;
  
  // Recorremos los 8 bits del byte original
  for(int i = 0; i < 8; i++) 
    {
      // Desplazamos el bit i-esimo del byte original a la posicin opuesta
      if(byte & (1 << i)) 
        {
          resultado |= (1 << (7 - i));
        }
    }
  
  return resultado;
}


/**-------------------------------------------------------------------------------------------------------------------
* 
* @fn         bool DIOLINUXLEDNEOPIXELWS2812BRPI::RP1SPICreate(RP1_T* rp1, uint8_t spinum, RP1_SPI_INSTANCE_T** spi)
* @brief      RP1SPICreate
* @ingroup    PLATFORM_LINUX
* 
* @param[in]  rp1 : 
* @param[in]  spinum : 
* @param[in]  spi : 
* 
* @return     bool : true if is succesful. 
* 
* --------------------------------------------------------------------------------------------------------------------*/
bool DIOLINUXLEDNEOPIXELWS2812BRPI::RP1SPICreate(RP1_T* rp1, uint8_t spinum, RP1_SPI_INSTANCE_T** spi)
{
  RP1_SPI_INSTANCE_T* _spi = (RP1_SPI_INSTANCE_T *)calloc(1, sizeof(RP1_SPI_INSTANCE_T));
  if(!_spi)
    {
      return false;
    }

  _spi->regbase   = rp1->rp1_peripherial_base + spi_bases[spinum];
  _spi->txdata    = (char*)0x0;
  _spi->rxdata    = (char*)0x0;
  _spi->txcount   = 0x0;

  (*spi) = _spi;

  return true;
}


/**-------------------------------------------------------------------------------------------------------------------
* 
* @fn         void DIOLINUXLEDNEOPIXELWS2812BRPI::RP1SPIWriteArrayBlocking(RP1_SPI_INSTANCE_T* spi, uint8_t data[], int data_length)
* @brief      RP1SPIWriteArrayBlocking
* @ingroup    PLATFORM_LINUX
* 
* @param[in]  spi : 
* @param[in]  data[] : 
* @param[in]  data_length : 
* 
* --------------------------------------------------------------------------------------------------------------------*/
void DIOLINUXLEDNEOPIXELWS2812BRPI::RP1SPIWriteArrayBlocking(RP1_SPI_INSTANCE_T* spi, uint8_t data[], int data_length)
{
  while(*(volatile uint32_t *)(spi->regbase + DW_SPI_SR) & DW_SPI_SR_BUSY)
    {
      // wait until the spi is not busy 
    }

  while(!(*(volatile uint32_t *)(spi->regbase + DW_SPI_SR) & DW_SPI_SR_TF_NOT_FULL))
    {
      // spin until we can write to the fifo 
    }

  // set the CS pin
  *(volatile uint32_t *)(spi->regbase + DW_SPI_SER) = 1 <<0;

  for(int data_byte = 0; data_byte < data_length; ++data_byte) 
    {
      for(int bits_byte = 0; bits_byte < 16; ++bits_byte) 
        {
          // put the data into the fifo
          *(volatile uint8_t *)(spi->regbase + DW_SPI_DR) = lookup_table[data[data_byte]][bits_byte];

          // we now need to pull exactly one byte out of the fifo which would
          // have been clocked in when we wrote the data
          /*uint8_t discard = */
          *(volatile uint8_t *)(spi->regbase + DW_SPI_DR);
        }
    }
}


/**-------------------------------------------------------------------------------------------------------------------
*
* @fn         void DIOLINUXLEDNEOPIXELWS2812BRPI::Clean()
* @brief      Clean the attributes of the class: Default initialice
* @note       INTERNAL
* @ingroup    DATAIO
*
* --------------------------------------------------------------------------------------------------------------------*/
void DIOLINUXLEDNEOPIXELWS2812BRPI::Clean()
{
  model     = RPI_MODEL_UNKNOWN;
  spi       = NULL;
}


#pragma endregion

